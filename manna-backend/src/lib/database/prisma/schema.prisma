generator client {
  provider = "prisma-client-js"
  // output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ProviderType {
  GOOGLE
  KAKAO
}

enum TimeUnit {
  DAY
  HOUR
  MINUTE
}

enum ScheduleType {
  INDIVIDUAL
  COMMON
}

enum MeetingType {
  OFFLINE
  ONLINE
  NONE
}

model ParticipationTimes {
  no                      Int                  @id @default(autoincrement())
  is_confirmed            Boolean              @default(false)
  enabled                 Boolean              @default(true)
  schedule_participant_no Int
  schedule_unit_no        Int
  create_datetime         DateTime?            @default(now()) @db.Timestamp(6)
  update_datetime         DateTime?            @updatedAt @db.Timestamp(6)
  schedule_participant    ScheduleParticipants @relation(fields: [schedule_participant_no], references: [no], onDelete: NoAction, onUpdate: NoAction)
  schedule_unit           ScheduleUnits        @relation(fields: [schedule_unit_no], references: [no], onDelete: NoAction, onUpdate: NoAction)

  @@map("participation_times")
}

model ScheduleParticipants {
  no                        Int                  @id @default(autoincrement())
  email                     String               @db.VarChar(100)
  name                      String               @db.VarChar(30)
  phone                     String?              @db.VarChar(100)
  memo                      String?              @db.VarChar(300)
  is_confirmation_mail_sent Boolean              @default(false)
  create_datetime           DateTime?            @default(now()) @db.Timestamp(6)
  update_datetime           DateTime?            @updatedAt @db.Timestamp(6)
  delete_datetime           DateTime?            @db.Timestamp(6)
  schedule_no               Int
  schedule                  Schedules            @relation(fields: [schedule_no], references: [no], onDelete: NoAction, onUpdate: NoAction)
  participation_times       ParticipationTimes[]

  @@map("schedule_participants")
}

model ScheduleUnits {
  no                  Int                  @id @default(autoincrement())
  date                String               @db.VarChar(15)
  time                String?              @db.VarChar(15)
  enabled             Boolean              @default(true)
  create_datetime     DateTime?            @default(now()) @db.Timestamp(6)
  update_datetime     DateTime?            @updatedAt @db.Timestamp(6)
  schedule_no         Int
  schedule            Schedules            @relation(fields: [schedule_no], references: [no], onDelete: NoAction, onUpdate: NoAction)
  participation_times ParticipationTimes[]

  @@map("schedule_units")
}

model Schedules {
  no                         Int                    @id @default(autoincrement())
  name                       String                 @db.VarChar(100)
  description                String?                @db.VarChar(200)
  type                       ScheduleType           @default(INDIVIDUAL)
  meeting_type               MeetingType            @default(OFFLINE)
  detail_address             String                 @db.VarChar(200)
  is_participant_visible     Boolean                @default(false)
  is_duplicate_participation Boolean                @default(false)
  start_date                 String                 @db.VarChar(15)
  end_date                   String                 @db.VarChar(15)
  start_time                 String?                @db.VarChar(15)
  end_time                   String?                @db.VarChar(15)
  time_unit                  TimeUnit               @default(DAY)
  time                       Int?
  enabled                    Boolean                @default(true)
  code                       String?                @db.VarChar(20)
  expiry_datetime            DateTime?              @db.Timestamp(6)
  create_datetime            DateTime?              @default(now()) @db.Timestamp(6)
  update_datetime            DateTime?              @updatedAt @db.Timestamp(6)
  delete_datetime            DateTime?              @db.Timestamp(6)
  user_no                    Int
  user                       Users                  @relation(fields: [user_no], references: [no], onDelete: NoAction, onUpdate: NoAction)
  schedule_participants      ScheduleParticipants[]
  schedule_units             ScheduleUnits[]
  region                     Region?                @relation(fields: [region_no], references: [no])
  region_no                  Int?
  region_detail              RegionDetail?          @relation(fields: [region_detail_no], references: [no])
  region_detail_no           Int?

  @@map("schedules")
}

model Users {
  no                   Int                  @id @default(autoincrement())
  name                 String               @db.VarChar(30)
  email                String               @unique @db.VarChar(100)
  password             String?              @db.VarChar(150)
  nickname             String?              @db.VarChar(30)
  phone                String?              @db.VarChar(20)
  enabled              Boolean              @default(true)
  create_datetime      DateTime?            @default(now()) @db.Timestamp(6)
  update_datetime      DateTime?            @updatedAt @db.Timestamp(6)
  delete_datetime      DateTime?            @db.Timestamp(6)
  schedules            Schedules[]
  user_social_accounts UserSocialAccounts[]

  @@map("users")
}

model UserSocialAccounts {
  no              Int          @id @default(autoincrement())
  provider        ProviderType @default(GOOGLE)
  id              String       @db.VarChar(30)
  create_datetime DateTime?    @default(now()) @db.Timestamp(6)
  update_datetime DateTime?    @updatedAt @db.Timestamp(6)
  delete_datetime DateTime?    @db.Timestamp(6)
  user_no         Int
  user            Users        @relation(fields: [user_no], references: [no])

  @@map("user_social_accounts")
}

model Region {
  no            Int            @id @default(autoincrement())
  name          String         @db.VarChar(20)
  schedules     Schedules[]
  region_detail RegionDetail[]

  @@map("regions")
}

model RegionDetail {
  no        Int         @id @default(autoincrement())
  region_no Int
  region    Region      @relation(fields: [region_no], references: [no], onDelete: NoAction, onUpdate: NoAction)
  name      String      @db.VarChar(20)
  schedules Schedules[]

  @@map("region_details")
}
